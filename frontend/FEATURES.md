# @æåŠåŠŸèƒ½ä½¿ç”¨è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

CrossWire å‰ç«¯ç°å·²é›†æˆå®Œæ•´çš„ **@æåŠ** åŠŸèƒ½ï¼Œè®©å›¢é˜Ÿæˆå‘˜å¯ä»¥åœ¨èŠå¤©å’Œé¢˜ç›®è®¨è®ºä¸­å¿«é€Ÿ@å…¶ä»–æˆå‘˜ã€‚

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½è§¦å‘
- **è¾“å…¥ @ ç¬¦å·**è‡ªåŠ¨å¼¹å‡ºæˆå‘˜é€‰æ‹©å™¨
- è‡ªåŠ¨æ£€æµ‹ @ å‰åçš„ç©ºæ ¼/æ¢è¡Œ
- æ”¯æŒåœ¨æ¶ˆæ¯ä»»æ„ä½ç½®æ’å…¥

### 2. å®æ—¶æœç´¢
- **è¾¹è¾“å…¥è¾¹è¿‡æ»¤**ï¼šè¾“å…¥ `@al` è‡ªåŠ¨ç­›é€‰å‡º "alice"
- æ”¯æŒæœç´¢ï¼š
  - æˆå‘˜åç§°
  - å½“å‰ä»»åŠ¡
  - æŠ€èƒ½æ ‡ç­¾

### 3. é”®ç›˜å¯¼èˆª
| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| â†‘ / â†“ | ä¸Šä¸‹é€‰æ‹©æˆå‘˜ |
| Enter | ç¡®è®¤é€‰æ‹©å½“å‰æˆå‘˜ |
| Tab | å¿«é€Ÿç¡®è®¤é€‰æ‹© |
| Esc | å–æ¶ˆé€‰æ‹©ï¼Œå…³é—­é¢æ¿ |
| é¼ æ ‡ç‚¹å‡» | ç›´æ¥é€‰æ‹©æˆå‘˜ |

### 4. è§†è§‰é«˜äº®
- **è“è‰²é«˜äº®**ï¼šæ™®é€š @æåŠ
- **çº¢è‰²é«˜äº®**ï¼šå½“ä½ è¢« @æ—¶
- **æ‚¬åœæ•ˆæœ**ï¼šé«˜äº®åŒºåŸŸå¯äº¤äº’
- **é€‚é…æ°”æ³¡**ï¼šè‡ªå·±å‘é€çš„æ¶ˆæ¯ä¸­æ ·å¼è‡ªé€‚åº”

---

## ğŸ’» ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šæ‰‹åŠ¨è¾“å…¥ @
```
1. åœ¨è¾“å…¥æ¡†è¾“å…¥ @
2. è‡ªåŠ¨å¼¹å‡ºæˆå‘˜é€‰æ‹©å™¨
3. ç»§ç»­è¾“å…¥ç­›é€‰ï¼ˆå¯é€‰ï¼‰
4. ç”¨é”®ç›˜â†‘â†“æˆ–é¼ æ ‡é€‰æ‹©æˆå‘˜
5. æŒ‰ Enter æˆ–ç‚¹å‡»ç¡®è®¤
```

### æ–¹æ³•äºŒï¼šå·¥å…·æ æŒ‰é’®
```
1. ç‚¹å‡»å·¥å…·æ çš„ @ æŒ‰é’®
2. è‡ªåŠ¨æ’å…¥ @ ç¬¦å·å¹¶æ‰“å¼€é€‰æ‹©å™¨
3. é€‰æ‹©æˆå‘˜
```

---

## ğŸ¨ ç•Œé¢è¯´æ˜

### æˆå‘˜é€‰æ‹©å™¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é€‰æ‹©æˆå‘˜    â†‘â†“é€‰æ‹© Enterç¡®è®¤ Escå–æ¶ˆâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŸ¢ alice                    [Web]  â”‚ â† åœ¨çº¿æˆå‘˜
â”‚     æ­£åœ¨è§£é¢˜: SQLæ³¨å…¥              â”‚
â”‚                                     â”‚
â”‚  âšª bob                      [Pwn]  â”‚ â† ç¦»çº¿æˆå‘˜
â”‚     ç¦»çº¿                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ‰¾åˆ° 2 ä¸ªæˆå‘˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶ˆæ¯ä¸­çš„æ˜¾ç¤º
```
æ™®é€šæ¶ˆæ¯:
  alice: å¤§å®¶å¿«çœ‹ @bob çš„æ€è·¯å¾ˆæ£’ï¼
         â†‘ @bob æ˜¾ç¤ºä¸ºè“è‰²èƒŒæ™¯

è¢«@çš„æ¶ˆæ¯ï¼ˆä½ æ˜¯bobï¼‰:
  alice: å¤§å®¶å¿«çœ‹ @bob çš„æ€è·¯å¾ˆæ£’ï¼
         â†‘ @bob æ˜¾ç¤ºä¸ºçº¢è‰²èƒŒæ™¯ï¼ˆæé†’ä½ è¢«@äº†ï¼‰
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### ç»„ä»¶ç»“æ„
```
MessageInput.vue
â”œâ”€ æ£€æµ‹ @ è¾“å…¥
â”œâ”€ è§£æå…‰æ ‡ä½ç½®
â”œâ”€ è°ƒç”¨ MentionSelector
â””â”€ æ’å…¥é€‰ä¸­æˆå‘˜

MentionSelector.vue
â”œâ”€ æˆå‘˜åˆ—è¡¨å±•ç¤º
â”œâ”€ å®æ—¶æœç´¢è¿‡æ»¤
â”œâ”€ é”®ç›˜äº‹ä»¶å¤„ç†
â””â”€ é€‰æ‹©å›è°ƒ

MessageList.vue
â”œâ”€ è§£ææ¶ˆæ¯ä¸­çš„ @
â”œâ”€ é«˜äº®æ¸²æŸ“ @æåŠ
â””â”€ åŒºåˆ†æ˜¯å¦@å½“å‰ç”¨æˆ·
```

### æ•°æ®æµ
```
1. ç”¨æˆ·è¾“å…¥ "@a"
   â†“
2. MessageInput æ£€æµ‹åˆ° @
   â†“
3. è§¦å‘ MentionSelectorï¼Œä¼ å…¥æœç´¢æ–‡æœ¬ "a"
   â†“
4. MentionSelector è¿‡æ»¤æˆå‘˜åˆ—è¡¨
   â†“
5. ç”¨æˆ·é€‰æ‹© "alice"
   â†“
6. æ’å…¥ "@alice " åˆ°è¾“å…¥æ¡†
   â†“
7. å‘é€æ¶ˆæ¯æ—¶è§£æ @æåŠ
   â†“
8. MessageList æ¸²æŸ“æ—¶é«˜äº® @alice
```

---

## ğŸ“ ç¤ºä¾‹åœºæ™¯

### åœºæ™¯ 1ï¼šå›¢é˜Ÿåä½œ
```
alice: @bob @charlie è¿™é“é¢˜éœ€è¦é…åˆï¼Œbobè´Ÿè´£Pwnï¼Œcharlieè´Ÿè´£Web
bob: @alice æ”¶åˆ°ï¼Œæˆ‘å…ˆçœ‹çœ‹æœ‰æ²¡æœ‰æº¢å‡ºç‚¹
charlie: @bob æˆ‘è¿™è¾¹å‘ç°äº†SQLæ³¨å…¥ï¼Œä½ é‚£è¾¹è¿›å±•å¦‚ä½•ï¼Ÿ
```

### åœºæ™¯ 2ï¼šé¢˜ç›®è®¨è®º
```
åœ¨ ChallengeRoomï¼ˆé¢˜ç›®è®¨è®ºå®¤ï¼‰ä¸­ï¼š

alice: @all æˆ‘æ‰¾åˆ°äº†Flagæ ¼å¼
bob: @alice åœ¨å“ªï¼Ÿ
charlie: @alice @bob æˆ‘ä¹Ÿæƒ³çŸ¥é“
```

### åœºæ™¯ 3ï¼šç´§æ€¥æ±‚åŠ©
```
dave: @admin æœåŠ¡å™¨æ–­çº¿äº†
admin: @dave æ”¶åˆ°ï¼Œé©¬ä¸Šå¤„ç†
admin: @all ç½‘ç»œå·²æ¢å¤ï¼Œè¯·é‡æ–°è¿æ¥
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### é€‚åˆä½¿ç”¨ @ çš„æ—¶å€™ï¼š
- âœ… éœ€è¦ç‰¹å®šæˆå‘˜æ³¨æ„æŸæ¡æ¶ˆæ¯
- âœ… åˆ†é…ä»»åŠ¡æˆ–è¯·æ±‚å¸®åŠ©
- âœ… å›å¤ç‰¹å®šæˆå‘˜çš„é—®é¢˜
- âœ… ç´§æ€¥é€šçŸ¥æŸäºº
- âœ… é¢˜ç›®åä½œä¸­æŒ‡å®šè´Ÿè´£äºº

### ä¸éœ€è¦ @ çš„æ—¶å€™ï¼š
- âŒ æ™®é€šé—²èŠ
- âŒ å…¬å¼€ä¿¡æ¯é€šçŸ¥ï¼ˆé™¤éç”¨ @allï¼‰
- âŒ è‡ªè¨€è‡ªè¯­æˆ–è®°å½•

---

## ğŸ”” é€šçŸ¥æœºåˆ¶ï¼ˆæœªæ¥åŠŸèƒ½ï¼‰

å½“å‰ç‰ˆæœ¬çš„ @æåŠåŠŸèƒ½å·²ç»å®ç°äº†ï¼š
- âœ… è¾“å…¥æ—¶çš„æˆå‘˜é€‰æ‹©
- âœ… æ¶ˆæ¯ä¸­çš„é«˜äº®æ˜¾ç¤º
- âœ… è§£ææåŠçš„æˆå‘˜

æœªæ¥å°†é›†æˆï¼ˆéœ€è¦åç«¯æ”¯æŒï¼‰ï¼š
- â³ @æåŠè§¦å‘æ¡Œé¢é€šçŸ¥
- â³ æœªè¯»@æ¶ˆæ¯è®¡æ•°
- â³ @æ¶ˆæ¯å†å²è®°å½•
- â³ @all å…¨ä½“é€šçŸ¥

---

## ğŸ¨ æ ·å¼å®šåˆ¶

### æ™®é€š @æåŠæ ·å¼
```css
.mention {
  color: #1890ff;              /* è“è‰²æ–‡å­— */
  background: rgba(24, 144, 255, 0.1);  /* æµ…è“èƒŒæ™¯ */
  padding: 2px 4px;
  border-radius: 2px;
  font-weight: 500;
}
```

### @åˆ°è‡ªå·±çš„æ ·å¼
```css
.mention-me {
  color: #f5222d;              /* çº¢è‰²æ–‡å­— */
  background: rgba(245, 34, 45, 0.1);   /* æµ…çº¢èƒŒæ™¯ */
}
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆè¾“å…¥ @ æ²¡æœ‰å¼¹å‡ºé€‰æ‹©å™¨ï¼Ÿ
A: ç¡®ä¿ï¼š
- @ å‰é¢æ˜¯ç©ºæ ¼ã€æ¢è¡Œæˆ–å¼€å¤´
- memberStore ä¸­æœ‰æˆå‘˜æ•°æ®
- è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹

### Q: å¦‚ä½•@å¤šä¸ªäººï¼Ÿ
A: å¤šæ¬¡ä½¿ç”¨ @ï¼Œå¦‚ï¼š`@alice @bob ä½ ä»¬çœ‹çœ‹è¿™ä¸ª`

### Q: å¯ä»¥@ä¸å­˜åœ¨çš„ç”¨æˆ·å—ï¼Ÿ
A: å¯ä»¥è¾“å…¥ï¼Œä½†ä¸ä¼šé«˜äº®æ˜¾ç¤ºï¼Œå› ä¸ºç³»ç»Ÿè¯†åˆ«ä¸å‡º

### Q: é”®ç›˜å¯¼èˆªä¸å·¥ä½œï¼Ÿ
A: ç¡®ä¿é€‰æ‹©å™¨å·²æ‰“å¼€ï¼ŒæŒ‰é”®ä¼šè¢«è‡ªåŠ¨æ•è·

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

- âœ… å®æ—¶æœç´¢ä½¿ç”¨ **computed** è®¡ç®—å±æ€§
- âœ… é”®ç›˜äº‹ä»¶ä½¿ç”¨ **é˜²æŠ–**é¿å…é¢‘ç¹è§¦å‘
- âœ… æ¶ˆæ¯æ¸²æŸ“ä½¿ç”¨ **escapeHtml** é˜²XSS
- âœ… æˆå‘˜å¤´åƒé¢œè‰²ä½¿ç”¨ **å“ˆå¸Œ**ç”Ÿæˆ
- âœ… é€‰æ‹©å™¨ä½ç½®ä½¿ç”¨ **getBoundingClientRect** ç²¾ç¡®å®šä½

---

## ğŸš€ æœªæ¥å¢å¼º

1. **@all å…¨ä½“é€šçŸ¥**
   - ç‰¹æ®Šè¯­æ³•æ”¯æŒ
   - æƒé™æ£€æŸ¥ï¼ˆä»…ç®¡ç†å‘˜ï¼‰

2. **@é¢‘é“ è·¨é¢‘é“æåŠ**
   - `@#channel-name`
   - è·¨é¢‘é“æ¶ˆæ¯æé†’

3. **@here åœ¨çº¿æˆå‘˜**
   - åªé€šçŸ¥å½“å‰åœ¨çº¿çš„äºº
   - å‡å°‘æ‰“æ‰°

4. **æ™ºèƒ½å»ºè®®**
   - æ ¹æ®æœ€è¿‘èŠå¤©æ¨è
   - æ ¹æ®å½“å‰è¯é¢˜æ¨è

---

## ğŸ“– API æ¥å£ï¼ˆå¾…é›†æˆï¼‰

```javascript
// å‘é€å¸¦@çš„æ¶ˆæ¯
emit('send', {
  content: "@alice ä½ å¥½",
  mentions: [
    {
      username: "alice",
      userId: "user_123",
      position: 0  // @ åœ¨æ¶ˆæ¯ä¸­çš„ä½ç½®
    }
  ]
})

// æ¥æ”¶æ¶ˆæ¯æ—¶æ£€æŸ¥æ˜¯å¦è¢«@
if (message.mentions.some(m => m.userId === currentUserId)) {
  // è§¦å‘é€šçŸ¥
  showNotification(`${message.senderName} @äº†ä½ `)
}
```

---

**åŠŸèƒ½çŠ¶æ€**: âœ… å·²å®Œæˆ  
**ç‰ˆæœ¬**: v1.0.0  
**æ›´æ–°æ—¶é—´**: 2025-10-05

